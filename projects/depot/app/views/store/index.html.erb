<% if notice %>
    <p id='notice>'>
      <% notice %></p>
<% end %>

<h1>Your Pragmatic Catalog</h1>
<!-- Come chiave mettiamo in prodotto, se su db non tocco niente lui non fa più query per recuperare prodotti
     se invece faccio un rake db:seed vengono aggiornati tutti quindi cambia la chiave e vengono ricaricati.
     Si può vedere tramite le query che fa su db. -->
<% cache ['store', Product.latest] do %>
    <% @products.each do |product| %>

        <!-- Qui invece fa la cache della singola entry, infatti non cambieranno sempre tutte e se c'è già in cache la prende da li-->
        <% cache ['entry', product] do %>
            <div class='entry'>
              <%= image_tag(product.image_url) %>
              <h3><%= product.title %></h3>
              <%= sanitize(product.description) %>
              <div class='price_line'>
                <span class='price'><%= number_to_currency(product.price, precision: 2, separator: ',', delimiter: '.', unit: '€') %></span>
                <%= button_to('Add to Cart', line_items_path(product_id: product)) %> <!-- Fa una POST. Quindi chiama create del line item controller-->
              </div>
            </div>
        <% end %>

    <% end %>
<% end %>

